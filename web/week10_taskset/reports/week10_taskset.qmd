---
title: "Week 10 Problem Set"
author: "Maya Komakhidze"
format: html
execute:
  echo: true
  warning: true
  message: true
---

# Generate dataset reproducibly
set.seed(1903)
subject_id <- 1:40
rt <- round(rnorm(40, mean = 520, sd = 120))
rt[sample(1:40, 2)] <- NA
congruent <- sample(c(TRUE, FALSE), 40, replace = TRUE)
condition <- sample(c("control", "incongruent"), 40, replace = TRUE)
experiment_data <- data.frame(subject_id, rt, congruent, condition)

# Save for reuse in later tasks
saveRDS(experiment_data, file = "data/raw/experiment_data.rds")

rm(list = ls())

#### Q1: Load and Inspect Data ------------------------------------

```{r}
## Load the saved dataset
experiment_data <- readRDS("../data/raw/experiment_data.rds")

## Take a quick look at the first few rows
head(experiment_data)

## Check the structure of the dataset
str(experiment_data)

```

#### Q2: Functions ------------------------------------------------

```{r}
## Generate one or more random numbers between min and max (defaults: one number between 1â€“10)
getRandomNumber <- function(min = 1, max = 10, number = 1) {
  sample(min:max, number)
}
```

```{r}
## Classify reaction times into "Fast", "Slow", or "Unknown" (default threshold = 500ms)
rt_class <- function(rt, threshold) {
  if (!is.numeric(threshold) || length(threshold) != 1) {
    stop("Error: 'threshold' must be a single numeric value.")
  }
  if (!is.numeric(rt)) {
    stop("Error: 'rt' must be numeric.")
  }
  category <- ifelse(
  is.na(rt), "unknown",
  ifelse(rt<500, "fast", "slow")
  )
  return(category)
}
rt <- c(1, 501, 100, NA)

rt_class(rt, 500)  

```

### Q3: Loops vs. Vectorization -------------------------
```{r}
experiment_data$age <- NA

```